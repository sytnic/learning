## 39. Best practices for managing PHP projects

Код

Лучше использовать относительные url без указания протокола (http, https). Эти url законны и полноправны.

    //domain.com/path/to/file.jpg

Использовать 

- осмысленные названия проектов
- в коде относительные пути вместо абсолютных или конфигурационный файл с путями
- Git

## 40. Installing Composer dependency manager

getcomposer.org

Скопировать в sharefolder файл composer.sh из Exercises Files.

    cd /media/sf_mysharefolder

Установить Композер

    ./composer.sh

Если всё корректно, никакого вывода на экран не будет.

Убедиться, что composer.phar существует.

    ls -la composer.phar

Переместить и тем самым сделать глобально доступным composer

    sudo mv composer.phar /usr/local/bin/composer

Убедиться, что composer работает

    composer about
    composer help

Доступные команды

    composer list

Отчет о состоянии

    composer diagnose

## 41. Installing WordPress and WP-CLI


    cd /media/sf_sandbox
    или
    cd /media/sf_mysharefolder

Скачивание

    wget https://wordpress.org/latest.tar.gz

Извлечение из архива

    tar -xzvf latest.tar.gz

Удаление архива

    rm latest.tar.gz

В браузере, чтобы завершить установку

    sandbox.dev:8080/wordpress/
    или
    127.0.0.1:8080/wordpress/

После установки - админ-панель и сам сайт

    127.0.0.1:8080/wordpress/wp-login.php
    127.0.0.1:8080/wordpress/

Проверка письма от wordpress

    127.0.0.1:1080


### Установка интерфейса командной строки

https://wp-cli.org/  

Скачивание

    wget https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar

Глобализация файла для системы

    sudo mv wp-cli.phar /usr/local/bin/wp

CLI в действии. 

    cd wordpress
    или
    cd /media/sf_sandbox/wordpress

CLI вызывается командой wp.  
Показать список команд.

    wp 
    q - для выхода

Список доступных тем

    wp theme list

Справка

    wp help
    q - для выхода

## 42. Installing Drupal, Drush, and Console

### Drupal

drupal.org - https://new.drupal.org/home

https://ftp.drupal.org/files/projects/

Установка

    cd /media/sf_sandbox
    или
    cd /media/sf_mysharefolder

    wget https://ftp.drupal.org/files/projects/drupal-8.3.2.zip

    unzip drupal-8.3.2.zip

Перемещение в папку drupal

    mv drupal-8.3.2 drupal

Удвление ненужного архива

    rm drupal-8.3.2.zip

Далее перемещаемся в папку `/media/sf_sandbox/drupal`

    cd drupal

### Drush

https://www.drush.org/

Продолжение установки

    composer require drush/drush

### Drupal Console

drupalconsole.com - https://octahedroid.com/drupal-console

Продолжение установки

    composer require drupal/console:~1.0 --prefer-dist --optimize-autoload

Далее в браузере

    sandbox.dev:8080/drupal/
    или
    127.0.0.1:8080/drupal/

### После установки

#### Исправление ошибки "Trusted Hos Settings" в отчетах Drupal. 

В файле `druapl/core/sites/default/files/settings.php` снять "Только чтение" (для Windows). Найти раздел с "trusted_host_patterns". Ниже создать и добавить регулярное выражение:

```php
    $settings['trusted_host_patterns'] = [
        '^sandbox\.dev$'
    ];
```

#### Работа с командной строкой

> Drush

Узнать статус сайта

    ./vendor/bin/drush status

Справка

    ./vendor/bin/drush help

> Console

Статус

    ./vendor/bin/drupal site:status

Список команд

    ./vendor/bin/drupal list

## 43. Installing Symfony

Переход в папку

    cd /media/sf_sandbox
    или
    cd /media/sf_mysharefolder

Установка в папку symfony

    composer sreate-project symfony/framework-standard-edition symfony

Установка спрашиваемых в CLI параметров

    localhost
    port: null
    db: symfony
    db_user: symfony
    db_pass: symfony
    mailer_transport: sendmail
    mailer_host: 127.0.0.1
    mailer_user: null
    mailer_pass: null
    secret (Token): hunter2

Отредактировать в проекте symfony `/web/app.dev.php` в строке 13. Вместо существующего if вставить

    if ($_SERVER['SERVER_NAME'] !== 'sandbox.dev')

В браузере

    sandbox.dev:8080/symfony/web/app_dev.php

## 44. Installing CodeIgniter

codeigniter.com

Переход в папку

    cd /media/sf_sandbox
    или
    cd /media/sf_mysharefolder

Установка согласно рекомендациям без Composer.

Загрузка

    wget --content-disposition https://codeload.github.com/bcit-ci/CodeIgniter/zip/3.1.4

Распаковка

    unzip CodeIgniter-3.1.4.zip

Переименование папки

    mv CodeIgniter-3.1.4 codeigniter

Удаление архива

    rm CodeIgniter-3.1.4.zip

Настройка конфигурации в редакторе.

Файл `application/config/autoload.php`.  
Вместо

    $autoload['packages'] = array();

надо

    $autoload['packages'] = array('database');

Файл `application/config/config.php`.  
Вместо

    $config['base_url'] = '';

надо

    $config['base_url'] = 'http://sandbox.dev:8080/codeigniter';

Файл `application/config/database.php`.  
Вместо

    $db['default'] = array(
        ...
        'hostname' => 'localhost',
        'username' => '',
        'password' => '',
        'database' => '',
        ...
    );

надо

    $db['default'] = array(
        ...
        'hostname' => 'localhost',
        'username' => 'codeigniter',
        'password' => 'codeigniter',
        'database' => 'codeigniter',
        ...
    );

В браузере

    http://sandbox.dev:8080/codeigniter

## 45. Installing Laravel and Artisan

https://laravel.com/

Переход в папку

    cd /media/sf_sandbox
    или
    cd /media/sf_mysharefolder

Установка с Composer в папку laravel

    composer create-project --prefer-dist laravel/laravel laravel

Настройка конфигурации

Файл `.env`

    APP_NAME="Laravel Sandbox"

    APP_URL=http://sandbox.dev:8080/laravel/public
    APP_URL=http://127.0.0.1:8080/laravel/public

    DB_HOST=localhost
    DB_DATABASE=laravel
    DB_USERNAME=laravel
    DB_PASSWORD=laravel

    MAIL_HOST=localhost
    MAIL_PORT=1025 (порт от MailCatcher)

В браузере

    http://sandbox.dev:8080/laravel/public
    или
    http://127.0.0.1:8080/laravel/public

Artisan

    cd laravel

    php artisan list

Команда для отладки laravel

    php artisan tinker

Запускается тестовая Shell-среда

Тест отправки письма

    Mail::send('welcome', [], function($message) {$message->to('username@example.com')->subject('testing'); });

В браузере проверка письма в MailCatcher

    http://127.0.0.1:1080
    
---
