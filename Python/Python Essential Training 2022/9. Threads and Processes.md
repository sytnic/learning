## 053-Multithreading

Threads

```py
import threading
import time

# возведение в квадрат
def longSquare(num):
    time.sleep(1)
    return num**2

# Один поток
[longSquare(n) for n in range(0, 5)]
# [0, 1, 4, 9, 16]
```

Несколько потоков. Но в этом случае не будут показаны результаты, и их нельзя выловить.  

```py
t1 = threading.Thread(target=longSquare, args=(1,))
t2 = threading.Thread(target=longSquare, args=(2,))

# Запустить оба потока
t1.start()
t2.start()

t1.join()
t2.join()

```

В этом случае будут выловлены и показаны результаты благодаря словарю `results`.  

```py
def longSquare(num, results):
    time.sleep(1)
    results[num] = num**2

results = {}
t1 = threading.Thread(target=longSquare, args=(1,results))
t2 = threading.Thread(target=longSquare, args=(2,results))

t1.start()
t2.start()

t1.join()
t2.join()

print(results)
# {2: 4, 1: 1}
```

То же самое, но используется список вместо словаря для краткости.  
В нём вычисляются значения для чисел от 0 до ста, и почти мгновенно.
```py
def longSquare(num, results):
    time.sleep(1)
    results[num] = num**2

results = {}
threads = [threading.Thread(target=longSquare, args=(n, results)) for n in range(0, 100)]
[t.start() for t in threads]
[t.join() for t in threads]
print(results)

# {2: 4, 1: 1, 0: 0, 8: 64, 9: 81, 16: 256, 17: 289, 19: 361, ... 68: 4624, 80: 6400, 88: 7744, 89: 7921, 48: 2304, 57: 3249, 71: 5041, 72: 5184, 76: 5776, 54: 2916, 56: 3136, 55: 3025, 58: 3364, 59: 3481}
```

## 054-Multiprocessing

Мультипроцессорность - возможность запускать несколько файлов одновременно.  
По умолчанию используются эти библиотеки.

```py
from multiprocessing import Process
```

Но из-за некоторых проблем с ними, например, в Юпитере, следует установить отдельный пакет, аналогичный мультипроцессорности по умолчанию. 

    pip install multiprocess

И теперь можно использовать

```py
from multiprocess import Process
```

Processes

```py

from multiprocess import Process
import time
import threading
```

```py

def longSquare(num, results):
    time.sleep(1)
    print(num**2)

results = {}
p1 = Process(target=longSquare, args=(1,results))
p2 = Process(target=longSquare, args=(2,results))

p1.start()
p2.start()

p1.join()
p2.join()

print(results)

# 14
# это не 14 - сначала показывает 1, а потом сразу 4,
# возводит в корень 1 и потом 2

# {}
```


```py

def longSquare(num, results):
    time.sleep(1)
    print(num**2)
    print('Finished computing!')

results = {}
processes = [Process(target=longSquare, args=(n,results)) for n in range(0, 10)]
[p.start() for p in processes]
[p.join() for p in processes]

# 01
# 4
# 9
# Finished computing!Finished computing!16
# 25Finished computing!

# 36Finished computing!

# 49Finished computing!64

# 81Finished computing!
# Finished computing!

# Finished computing!Finished computing!
# Finished computing!

# [None, None, None, None, None, None, None, None, None, None]

```

```py

results = {}
threads = [threading.Thread(target=longSquare, args=(n, results)) for n in range(0, 10)]
[t.start() for t in threads]
[t.join() for t in threads]
print(results)

# 9163625496481
# Finished computing!
# 14

# Finished computing!

# Finished computing!
# Finished computing!


# Finished computing!
# Finished computing!
# 0Finished computing!
# Finished computing!

# Finished computing!
# Finished computing!

# {}

```

---
